name: Helloworld example

requires: 2.0.0

needs:
  - docker
  - ssh

dockerHosts:
  mbb:
    inheritsFrom: 
      - ../../fabalicious/2.0/mbb-docker.yaml 
    environment:
      VHOST: "%host.host%"
      ROOT_FOLDER: "%dockerHost.rootFolder%/%host.docker.projectFolder%"

    tasks:
      logs:
        - cd $ROOT_FOLDER; docker-compose logs

      stop:
        - cd $ROOT_FOLDER; docker-compose stop
      rm:
        - execute(docker, stop)
        - cd $ROOT_FOLDER; docker-compose rm -f 

      rebuild:
        - cd $ROOT_FOLDER; docker-compose pull
        
      run:
        - cd $ROOT_FOLDER; docker-compose up -d
        - execute(docker, reload_haproxy)

hosts:
  mbb:
    host: helloworld.dev
    user: vagrant
    password: vagrant
    rootFolder: /var/www
    filesFolder: ""
    backupFolder: ""
    siteFolder: ""

    docker:
      name: helloworld
      configuration: mbb
      projectFolder: helloworld

    deploy:
      - echo "hier"
      - execute(docker, run)
